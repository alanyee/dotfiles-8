#!/usr/bin/env bash
# the windows duplicate (#) thing
# example: dmesg >$(dup out.txt)

target="$1"
while [ -f "$target" ]; do
    file="$(basename -- "$target")"

    if [[ $file == *.* ]]; then
    	ext=".${filename##*.}"
	file="${filename%.*}"
    else
	ext=""
    fi

    if [[ $file == *\) ]]; then
	# todo: this better
	cur_num="$(echo "$file" | grep -Eo "([0-9])" )"
	cur_num=${cur_num/(}
	cur_num=${cur_num/)}
	next_num="$(($cur_num + 1))"

	target="${file/$cur_num/$next_num}${ext}"
    else
	target="$file (1)$ext"
    fi
done

echo "$target"
